{
  "hash": "dc2af9ed411323a5f98c4be67227d302",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Logical Vectors\"\nsubtitle: \"Lecture 9\"\ntitle-slide-attributes:\n  data-background-image: ../vizdata-bg.png\n  data-background-size: stretch\n  data-slide-number: none\nformat: revealjs\n---\n\n\n::: {.cell}\n\n:::\n\n\n# Introduction\n\n## Logical Vectors\n\n- A logical vector is a vector that contains only `TRUE`, `FALSE`, and `NA` (missing) values.\n- They are rarely in your raw data, but you will create and use them in almost every analysis.\n- Logical vectors are the foundation of filtering and conditional transformations.\n\n# Comparisons\n\n## Creating Logicals\n\n- You can create logical vectors with comparison operators:\n  - `>` (greater than), `<` (less than)\n  - `>=` (greater than or equal to), `<=` (less than or equal to)\n  - `==` (equal to), `!=` (not equal to)\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nx <- c(1, 2, 3, 5, 8, 13)\nx > 4\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] FALSE FALSE FALSE  TRUE  TRUE  TRUE\n```\n\n\n:::\n:::\n\n\n## Comparisons with `filter()`\n\n- Most often, you'll use comparisons inside `filter()` to select rows.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Flights that departed in January\nfilter(flights, month == 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 27,004 × 19\n    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time\n   <int> <int> <int>    <int>          <int>     <dbl>    <int>          <int>\n 1  2013     1     1      517            515         2      830            819\n 2  2013     1     1      533            529         4      850            830\n 3  2013     1     1      542            540         2      923            850\n 4  2013     1     1      544            545        -1     1004           1022\n 5  2013     1     1      554            600        -6      812            837\n 6  2013     1     1      554            558        -4      740            728\n 7  2013     1     1      555            600        -5      913            854\n 8  2013     1     1      557            600        -3      709            723\n 9  2013     1     1      557            600        -3      838            846\n10  2013     1     1      558            600        -2      753            745\n# ℹ 26,994 more rows\n# ℹ 11 more variables: arr_delay <dbl>, carrier <chr>, flight <int>,\n#   tailnum <chr>, origin <chr>, dest <chr>, air_time <dbl>, distance <dbl>,\n#   hour <dbl>, minute <dbl>, time_hour <dttm>\n```\n\n\n:::\n:::\n\n\n## Floating Point Comparison\n\n- Be careful when using `==` with numbers. Computers can have small rounding errors.\n- Use `dplyr::near()` to compare two numbers for \"close enough\" equality.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# This might be FALSE due to floating point math!\n1/3 * 3 == 1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] TRUE\n```\n\n\n:::\n\n```{.r .cell-code}\n# This is a safer way to compare\nnear(1/3 * 3, 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] TRUE\n```\n\n\n:::\n:::\n\n\n# Missing Values\n\n## `NA`\n\n- `NA` represents a missing value.\n- `NA` is \"contagious\": almost any operation involving `NA` will produce `NA`.\n- You can't use `==` to find missing values.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nNA > 5\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] NA\n```\n\n\n:::\n\n```{.r .cell-code}\nNA == 10\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] NA\n```\n\n\n:::\n\n```{.r .cell-code}\nNA == NA\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] NA\n```\n\n\n:::\n:::\n\n\n## `is.na()`\n\n- Use the `is.na()` function to test if a value is missing.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nx <- c(1, NA, 3)\nis.na(x)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] FALSE  TRUE FALSE\n```\n\n\n:::\n:::\n\n\n## Filtering and `NA`\n\n- `filter()` only includes rows where the condition is `TRUE`. It excludes `FALSE` and `NA` values.\n- If you want to include missing values in your filter, you must ask for them explicitly.\n\n## Example\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\"}\ndf <- tibble(x = c(1, NA, 3))\n\n# This only keeps the row where x > 1 is TRUE\ndf |> \n  filter(x > 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 1\n      x\n  <dbl>\n1     3\n```\n\n\n:::\n\n```{.r .cell-code  code-fold=\"true\"}\n# To keep NA values, you have to say so\ndf |>\n  filter(x > 1 | is.na(x))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 1\n      x\n  <dbl>\n1    NA\n2     3\n```\n\n\n:::\n:::\n\n\n## Practice!\n\nLet's do some practice!\n\n# Boolean Algebra\n\n## Combining Conditions\n\n- You can combine multiple logical conditions using boolean operators:\n  - `&` (and)\n  - `|` (or)\n  - `!` (not)\n\n## Example 1\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Flights in January or February\nflights |>\n  filter(month == 1 | month == 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 51,955 × 19\n    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time\n   <int> <int> <int>    <int>          <int>     <dbl>    <int>          <int>\n 1  2013     1     1      517            515         2      830            819\n 2  2013     1     1      533            529         4      850            830\n 3  2013     1     1      542            540         2      923            850\n 4  2013     1     1      544            545        -1     1004           1022\n 5  2013     1     1      554            600        -6      812            837\n 6  2013     1     1      554            558        -4      740            728\n 7  2013     1     1      555            600        -5      913            854\n 8  2013     1     1      557            600        -3      709            723\n 9  2013     1     1      557            600        -3      838            846\n10  2013     1     1      558            600        -2      753            745\n# ℹ 51,945 more rows\n# ℹ 11 more variables: arr_delay <dbl>, carrier <chr>, flight <int>,\n#   tailnum <chr>, origin <chr>, dest <chr>, air_time <dbl>, distance <dbl>,\n#   hour <dbl>, minute <dbl>, time_hour <dttm>\n```\n\n\n:::\n:::\n\n\n## Example 2\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Flights not delayed (on departure or arrival)\nflights |> \nfilter(!(dep_delay > 0 | arr_delay > 0))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 158,900 × 19\n    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time\n   <int> <int> <int>    <int>          <int>     <dbl>    <int>          <int>\n 1  2013     1     1      544            545        -1     1004           1022\n 2  2013     1     1      554            600        -6      812            837\n 3  2013     1     1      557            600        -3      709            723\n 4  2013     1     1      557            600        -3      838            846\n 5  2013     1     1      558            600        -2      849            851\n 6  2013     1     1      558            600        -2      853            856\n 7  2013     1     1      558            600        -2      923            937\n 8  2013     1     1      559            559         0      702            706\n 9  2013     1     1      559            600        -1      854            902\n10  2013     1     1      600            600         0      851            858\n# ℹ 158,890 more rows\n# ℹ 11 more variables: arr_delay <dbl>, carrier <chr>, flight <int>,\n#   tailnum <chr>, origin <chr>, dest <chr>, air_time <dbl>, distance <dbl>,\n#   hour <dbl>, minute <dbl>, time_hour <dttm>\n```\n\n\n:::\n:::\n\n\n## `%in%`\n\n- A useful shortcut for `x == a | x == b | x == c` is `x %in% c(a, b, c)`.\n- It checks if each value in the left vector is present in the right vector.\n\n## Example\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Flights in November or December\nflights |>\n  filter(month %in% c(11, 12))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 55,403 × 19\n    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time\n   <int> <int> <int>    <int>          <int>     <dbl>    <int>          <int>\n 1  2013    11     1        5           2359         6      352            345\n 2  2013    11     1       35           2250       105      123           2356\n 3  2013    11     1      455            500        -5      641            651\n 4  2013    11     1      539            545        -6      856            827\n 5  2013    11     1      542            545        -3      831            855\n 6  2013    11     1      549            600       -11      912            923\n 7  2013    11     1      550            600       -10      705            659\n 8  2013    11     1      554            600        -6      659            701\n 9  2013    11     1      554            600        -6      826            827\n10  2013    11     1      554            600        -6      749            751\n# ℹ 55,393 more rows\n# ℹ 11 more variables: arr_delay <dbl>, carrier <chr>, flight <int>,\n#   tailnum <chr>, origin <chr>, dest <chr>, air_time <dbl>, distance <dbl>,\n#   hour <dbl>, minute <dbl>, time_hour <dttm>\n```\n\n\n:::\n:::\n\n\n## Practice!\n\nLet's do some practice!\n\n# Summarizing Logicals\n\n## Logical Summaries\n\n- `any()`: returns `TRUE` if there is at least one `TRUE`.\n- `all()`: returns `TRUE` if all values are `TRUE`.\n- Use `na.rm = TRUE` to ignore missing values.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nx <- c(TRUE, FALSE, NA)\nany(x)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] TRUE\n```\n\n\n:::\n\n```{.r .cell-code}\nall(x, na.rm = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] FALSE\n```\n\n\n:::\n:::\n\n\n## Numeric Summaries\n\n- When you use a logical vector in a numeric context, `TRUE` becomes `1` and `FALSE` becomes `0`.\n- `sum()`: counts the number of `TRUE`s.\n- `mean()`: calculates the proportion of `TRUE`s.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\"}\n# How many flights were delayed on arrival by more than an hour?\nsum(flights$arr_delay > 60, na.rm = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 27789\n```\n\n\n:::\n\n```{.r .cell-code  code-fold=\"true\"}\n# What proportion of flights were delayed?\nmean(flights$arr_delay > 0, na.rm = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.4063101\n```\n\n\n:::\n:::\n\n\n## Practice!\n\nLet's do some practice!\n\n# Conditional Transformations\n\n## `if_else()`\n\n- `if_else(condition, value_if_true, value_if_false)`\n- A safe and strict version of `if` that works well inside `mutate()`.\n- All output values must be of the same type.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nx <- c(-3, -1, 0, 1, 3)\nif_else(x > 0, \"positive\", \"negative or zero\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"negative or zero\" \"negative or zero\" \"negative or zero\" \"positive\"        \n[5] \"positive\"        \n```\n\n\n:::\n:::\n\n\n## `case_when()`\n\n- For multiple conditions, `case_when()` is easier to read than nested `if_else()`.\n- `case_when(condition1 ~ value1, condition2 ~ value2, ...)`\n- The first `TRUE` condition wins.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\"}\ncase_when(\n  x < 0 ~ \"negative\",\n  x == 0 ~ \"zero\",\n  x > 0 ~ \"positive\"\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"negative\" \"negative\" \"zero\"     \"positive\" \"positive\"\n```\n\n\n:::\n:::\n\n\n## Example: `case_when()`\n\n- Let's create a human-readable \"season\" variable.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\"}\nflights |>\n  mutate(\n    season = case_when(\n      month %in% c(12, 1, 2) ~ \"Winter\",\n      month %in% c(3, 4, 5) ~ \"Spring\",\n      month %in% c(6, 7, 8) ~ \"Summer\",\n      month %in% c(9, 10, 11) ~ \"Fall\"\n    )\n  ) |>\n  select(month, season)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 336,776 × 2\n   month season\n   <int> <chr> \n 1     1 Winter\n 2     1 Winter\n 3     1 Winter\n 4     1 Winter\n 5     1 Winter\n 6     1 Winter\n 7     1 Winter\n 8     1 Winter\n 9     1 Winter\n10     1 Winter\n# ℹ 336,766 more rows\n```\n\n\n:::\n:::\n\n\n# Practice\n\nLet's practice with logical vectors!\n\n# Summary\n\n## Logical Vectors\n\n- Create with comparisons: `<`, `==`, `%in%`, `is.na()`.\n- Combine with boolean operators: `&`, `|`, `!`.\n- Summarize with `any()`, `all()`, `sum()`, `mean()`.\n- Use for conditional transformations with `if_else()` and `case_when()`.\n- Logical vectors are a fundamental tool for data manipulation in R.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}